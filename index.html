<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>Receipt Scanner</title>
  <link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #0e0e0e;
      --surface: #1a1a1a;
      --surface2: #242424;
      --border: #2e2e2e;
      --accent: #c8f53f;
      --accent-dim: #9ab82d;
      --text: #f0f0f0;
      --text-muted: #888;
      --red: #ff5c5c;
      --success: #4dffb4;
      --radius: 16px;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Syne', sans-serif;
      min-height: 100vh;
      padding: 0;
      overflow-x: hidden;
    }

    /* HEADER */
    header {
      padding: 20px 20px 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo {
      font-size: 1.1rem;
      font-weight: 800;
      letter-spacing: -0.03em;
      color: var(--accent);
    }
    .logo span { color: var(--text-muted); font-weight: 400; }

    /* SETUP PANEL */
    .setup-panel {
      margin: 20px;
      background: var(--surface);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      overflow: hidden;
    }
    .setup-header {
      padding: 16px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      user-select: none;
    }
    .setup-header h3 {
      font-size: 0.85rem;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-muted);
    }
    .setup-header .chevron {
      color: var(--text-muted);
      font-size: 0.75rem;
      transition: transform 0.2s;
    }
    .setup-header.open .chevron { transform: rotate(180deg); }
    .setup-body {
      padding: 0 20px 20px;
      display: none;
      flex-direction: column;
      gap: 12px;
    }
    .setup-body.open { display: flex; }

    label {
      font-size: 0.78rem;
      color: var(--text-muted);
      font-family: 'DM Mono', monospace;
      display: block;
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }
    input[type="text"], input[type="password"] {
      width: 100%;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px 14px;
      color: var(--text);
      font-family: 'DM Mono', monospace;
      font-size: 0.82rem;
      outline: none;
      transition: border-color 0.2s;
    }
    input:focus { border-color: var(--accent); }
    .setup-note {
      font-size: 0.75rem;
      color: var(--text-muted);
      font-family: 'DM Mono', monospace;
      line-height: 1.5;
      background: var(--surface2);
      border-radius: 8px;
      padding: 10px 12px;
    }
    .setup-note a { color: var(--accent); text-decoration: none; }

    .status-dot {
      width: 8px; height: 8px;
      border-radius: 50%;
      background: var(--border);
      display: inline-block;
      margin-right: 6px;
    }
    .status-dot.green { background: var(--success); box-shadow: 0 0 6px var(--success); }
    .status-dot.yellow { background: var(--accent); box-shadow: 0 0 6px var(--accent); }

    /* MAIN SCANNER */
    .scanner-area {
      margin: 0 20px;
    }

    .upload-zone {
      background: var(--surface);
      border: 2px dashed var(--border);
      border-radius: var(--radius);
      padding: 40px 20px;
      text-align: center;
      cursor: pointer;
      transition: border-color 0.2s, background 0.2s;
      position: relative;
      overflow: hidden;
    }
    .upload-zone:hover, .upload-zone.drag-over {
      border-color: var(--accent);
      background: #1f2410;
    }
    .upload-zone input[type="file"] {
      position: absolute;
      inset: 0;
      opacity: 0;
      cursor: pointer;
      width: 100%;
      height: 100%;
    }
    .upload-icon {
      font-size: 2.5rem;
      margin-bottom: 12px;
    }
    .upload-title {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 6px;
    }
    .upload-sub {
      font-size: 0.8rem;
      color: var(--text-muted);
      font-family: 'DM Mono', monospace;
    }

    /* PREVIEW */
    .preview-wrap {
      display: none;
      margin-top: 16px;
      position: relative;
    }
    .preview-wrap.visible { display: block; }
    .preview-wrap img {
      width: 100%;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      max-height: 280px;
      object-fit: cover;
    }
    .preview-remove {
      position: absolute;
      top: 10px; right: 10px;
      background: rgba(0,0,0,0.7);
      border: 1px solid var(--border);
      border-radius: 50%;
      width: 32px; height: 32px;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer;
      font-size: 0.9rem;
      color: var(--text);
      backdrop-filter: blur(4px);
    }

    /* SCAN BUTTON */
    .btn-scan {
      width: 100%;
      margin-top: 16px;
      background: var(--accent);
      color: #0e0e0e;
      border: none;
      border-radius: var(--radius);
      padding: 18px;
      font-family: 'Syne', sans-serif;
      font-size: 1rem;
      font-weight: 800;
      letter-spacing: 0.02em;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .btn-scan:hover { background: #d4ff52; }
    .btn-scan:active { transform: scale(0.98); }
    .btn-scan:disabled {
      background: var(--surface2);
      color: var(--text-muted);
      cursor: not-allowed;
    }

    /* LOADING */
    .loading-bar {
      display: none;
      margin-top: 12px;
      height: 3px;
      background: var(--border);
      border-radius: 99px;
      overflow: hidden;
    }
    .loading-bar.visible { display: block; }
    .loading-bar-inner {
      height: 100%;
      background: var(--accent);
      border-radius: 99px;
      animation: loading 1.4s ease-in-out infinite;
    }
    @keyframes loading {
      0% { width: 0%; margin-left: 0; }
      50% { width: 70%; margin-left: 15%; }
      100% { width: 0%; margin-left: 100%; }
    }

    .loading-msg {
      display: none;
      text-align: center;
      margin-top: 10px;
      font-size: 0.8rem;
      color: var(--text-muted);
      font-family: 'DM Mono', monospace;
    }
    .loading-msg.visible { display: block; }

    /* RESULT CARD */
    .result-card {
      display: none;
      margin-top: 16px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
    }
    .result-card.visible { display: block; }
    .result-header {
      padding: 14px 18px;
      background: var(--surface2);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .result-header span {
      font-size: 0.75rem;
      font-weight: 600;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--text-muted);
      font-family: 'DM Mono', monospace;
    }
    .result-header .badge {
      background: #1a2e0a;
      color: var(--success);
      border: 1px solid #2a4a12;
      border-radius: 99px;
      padding: 3px 10px;
      font-size: 0.7rem;
    }

    .result-rows {
      padding: 6px 0;
    }
    .result-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 18px;
      border-bottom: 1px solid var(--border);
      gap: 12px;
    }
    .result-row:last-child { border-bottom: none; }
    .result-row-label {
      font-size: 0.72rem;
      color: var(--text-muted);
      font-family: 'DM Mono', monospace;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      min-width: 60px;
    }
    .result-row-value {
      font-size: 0.92rem;
      font-weight: 600;
      color: var(--text);
      text-align: right;
      flex: 1;
    }
    .result-row-value.price {
      color: var(--accent);
      font-size: 1.1rem;
      font-family: 'DM Mono', monospace;
    }
    .result-row-value input {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 6px 10px;
      color: var(--text);
      font-family: 'DM Mono', monospace;
      font-size: 0.85rem;
      width: 100%;
      text-align: right;
      outline: none;
    }
    .result-row-value input:focus { border-color: var(--accent); }

    .btn-submit {
      width: calc(100% - 36px);
      margin: 0 18px 18px;
      background: transparent;
      color: var(--success);
      border: 1px solid var(--success);
      border-radius: 10px;
      padding: 14px;
      font-family: 'Syne', sans-serif;
      font-size: 0.9rem;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .btn-submit:hover { background: rgba(77,255,180,0.08); }
    .btn-submit:disabled { opacity: 0.4; cursor: not-allowed; }

    /* TOAST */
    .toast {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%) translateY(80px);
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 99px;
      padding: 12px 20px;
      font-size: 0.82rem;
      font-family: 'DM Mono', monospace;
      white-space: nowrap;
      transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      z-index: 999;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .toast.show { transform: translateX(-50%) translateY(0); }
    .toast.success { border-color: var(--success); color: var(--success); }
    .toast.error { border-color: var(--red); color: var(--red); }

    /* HISTORY */
    .history-section {
      margin: 20px 20px 40px;
    }
    .section-label {
      font-size: 0.72rem;
      font-weight: 600;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--text-muted);
      font-family: 'DM Mono', monospace;
      margin-bottom: 12px;
    }
    .history-empty {
      font-size: 0.8rem;
      color: var(--text-muted);
      font-family: 'DM Mono', monospace;
      text-align: center;
      padding: 24px;
      background: var(--surface);
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }
    .history-item {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 14px 16px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      animation: slideIn 0.3s ease;
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .history-item-left { flex: 1; min-width: 0; }
    .history-item-merchant {
      font-size: 0.9rem;
      font-weight: 700;
      margin-bottom: 3px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .history-item-meta {
      font-size: 0.72rem;
      color: var(--text-muted);
      font-family: 'DM Mono', monospace;
    }
    .history-item-price {
      font-size: 1.05rem;
      font-weight: 700;
      color: var(--accent);
      font-family: 'DM Mono', monospace;
      margin-left: 12px;
    }

    .divider { height: 1px; background: var(--border); margin: 20px 20px 0; }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 99px; }
  </style>
</head>
<body>

<header>
  <div class="logo">receipt<span>.scan</span></div>
  <div style="font-size:0.75rem; font-family:'DM Mono',monospace; color:var(--text-muted);">
    <span class="status-dot" id="statusDot"></span><span id="statusText">not configured</span>
  </div>
</header>

<!-- SETUP PANEL -->
<div class="setup-panel" style="margin-top:16px;">
  <div class="setup-header" id="setupToggle">
    <h3>âš™ Setup</h3>
    <span class="chevron">â–¼</span>
  </div>
  <div class="setup-body" id="setupBody">

    <div>
      <label>Claude API Key</label>
      <input type="password" id="claudeKey" placeholder="sk-ant-..." />
    </div>

    <div>
      <label>Google Sheets ID</label>
      <input type="text" id="sheetId" placeholder="1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgVE2upms" />
      <div class="setup-note" style="margin-top:8px;">
        Found in your sheet URL: docs.google.com/spreadsheets/d/<strong style="color:var(--accent);">[ID HERE]</strong>/edit
      </div>
    </div>

    <div>
      <label>Google Apps Script Web App URL</label>
      <input type="text" id="scriptUrl" placeholder="https://script.google.com/macros/s/.../exec" />
      <div class="setup-note" style="margin-top:8px;">
        You need a small Google Apps Script to write to Sheets. <br/><br/>
        1. Open your Google Sheet â†’ Extensions â†’ Apps Script<br/>
        2. Paste the code below, then click Deploy â†’ New deployment â†’ Web App (Anyone can access)<br/>
        3. Copy the URL and paste it above<br/><br/>
        <strong style="color:var(--accent);">Apps Script code:</strong><br/>
        <code>function doPost(e){var sheet=SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();var d=JSON.parse(e.postData.contents);sheet.appendRow([d.date,d.merchant,d.items,d.total,new Date().toLocaleString()]);return ContentService.createTextOutput("ok");}</code>
      </div>
    </div>

    <button class="btn-scan" style="margin-top:4px;" onclick="saveConfig()">Save Configuration</button>
  </div>
</div>

<!-- SCANNER -->
<div class="scanner-area" style="margin-top:16px;">

  <div class="upload-zone" id="uploadZone">
    <input type="file" id="fileInput" accept="image/*" capture="environment" onchange="handleFile(event)" />
    <div class="upload-icon">ðŸ“·</div>
    <div class="upload-title">Scan a Receipt</div>
    <div class="upload-sub">tap to photograph or upload</div>
  </div>

  <div class="preview-wrap" id="previewWrap">
    <img id="previewImg" src="" alt="Receipt preview" />
    <div class="preview-remove" onclick="clearImage()">âœ•</div>
  </div>

  <div class="loading-bar" id="loadingBar"><div class="loading-bar-inner"></div></div>
  <div class="loading-msg" id="loadingMsg">reading your receipt with AIâ€¦</div>

  <button class="btn-scan" id="scanBtn" onclick="scanReceipt()" disabled>
    âœ¦ Extract & Sync to Google Sheets
  </button>

  <!-- RESULT CARD -->
  <div class="result-card" id="resultCard">
    <div class="result-header">
      <span>Extracted Data</span>
      <span class="badge">âœ“ Ready to sync</span>
    </div>
    <div class="result-rows">
      <div class="result-row">
        <span class="result-row-label">Date</span>
        <span class="result-row-value"><input type="text" id="resDate" /></span>
      </div>
      <div class="result-row">
        <span class="result-row-label">Merchant</span>
        <span class="result-row-value"><input type="text" id="resMerchant" /></span>
      </div>
      <div class="result-row">
        <span class="result-row-label">Items</span>
        <span class="result-row-value"><input type="text" id="resItems" /></span>
      </div>
      <div class="result-row">
        <span class="result-row-label">Total</span>
        <span class="result-row-value price"><input type="text" id="resTotal" /></span>
      </div>
    </div>
    <button class="btn-submit" id="submitBtn" onclick="syncToSheets()">
      â†— Add to Google Sheets
    </button>
  </div>

</div>

<div class="divider"></div>

<!-- HISTORY -->
<div class="history-section" style="margin-top:20px;">
  <div class="section-label">Recent Receipts</div>
  <div id="historyList">
    <div class="history-empty">No receipts scanned yet.<br/>Your history will appear here.</div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
  // â”€â”€ CONFIG â”€â”€
  let config = {
    claudeKey: localStorage.getItem('rcp_claude') || '',
    sheetId:   localStorage.getItem('rcp_sheet')  || '',
    scriptUrl: localStorage.getItem('rcp_script') || '',
  };

  let currentImageB64 = null;
  let history = JSON.parse(localStorage.getItem('rcp_history') || '[]');

  // â”€â”€ INIT â”€â”€
  window.onload = () => {
    if (config.claudeKey) document.getElementById('claudeKey').value = config.claudeKey;
    if (config.sheetId)   document.getElementById('sheetId').value   = config.sheetId;
    if (config.scriptUrl) document.getElementById('scriptUrl').value = config.scriptUrl;
    updateStatus();
    renderHistory();
    if (!config.claudeKey || !config.scriptUrl) openSetup();
  };

  function openSetup() {
    document.getElementById('setupBody').classList.add('open');
    document.getElementById('setupToggle').classList.add('open');
  }

  document.getElementById('setupToggle').onclick = () => {
    document.getElementById('setupBody').classList.toggle('open');
    document.getElementById('setupToggle').classList.toggle('open');
  };

  function saveConfig() {
    config.claudeKey = document.getElementById('claudeKey').value.trim();
    config.sheetId   = document.getElementById('sheetId').value.trim();
    config.scriptUrl = document.getElementById('scriptUrl').value.trim();
    localStorage.setItem('rcp_claude',  config.claudeKey);
    localStorage.setItem('rcp_sheet',   config.sheetId);
    localStorage.setItem('rcp_script',  config.scriptUrl);
    updateStatus();
    showToast('âœ“ Configuration saved', 'success');
    document.getElementById('setupBody').classList.remove('open');
    document.getElementById('setupToggle').classList.remove('open');
  }

  function updateStatus() {
    const dot  = document.getElementById('statusDot');
    const text = document.getElementById('statusText');
    if (config.claudeKey && config.scriptUrl) {
      dot.className = 'status-dot green';
      text.textContent = 'ready';
    } else if (config.claudeKey || config.scriptUrl) {
      dot.className = 'status-dot yellow';
      text.textContent = 'incomplete setup';
    } else {
      dot.className = 'status-dot';
      text.textContent = 'not configured';
    }
  }

  // â”€â”€ FILE HANDLING â”€â”€
  const uploadZone = document.getElementById('uploadZone');
  uploadZone.addEventListener('dragover', e => { e.preventDefault(); uploadZone.classList.add('drag-over'); });
  uploadZone.addEventListener('dragleave', () => uploadZone.classList.remove('drag-over'));
  uploadZone.addEventListener('drop', e => {
    e.preventDefault();
    uploadZone.classList.remove('drag-over');
    if (e.dataTransfer.files[0]) processFile(e.dataTransfer.files[0]);
  });

  function handleFile(e) {
    if (e.target.files[0]) processFile(e.target.files[0]);
  }

  function processFile(file) {
    if (!file.type.startsWith('image/')) { showToast('Please upload an image', 'error'); return; }
    const reader = new FileReader();
    reader.onload = (e) => {
      currentImageB64 = e.target.result.split(',')[1];
      document.getElementById('previewImg').src = e.target.result;
      document.getElementById('previewWrap').classList.add('visible');
      document.getElementById('scanBtn').disabled = false;
      document.getElementById('resultCard').classList.remove('visible');
    };
    reader.readAsDataURL(file);
  }

  function clearImage() {
    currentImageB64 = null;
    document.getElementById('previewImg').src = '';
    document.getElementById('previewWrap').classList.remove('visible');
    document.getElementById('scanBtn').disabled = true;
    document.getElementById('fileInput').value = '';
    document.getElementById('resultCard').classList.remove('visible');
  }

  // â”€â”€ SCAN WITH CLAUDE â”€â”€
  async function scanReceipt() {
    if (!config.claudeKey) { showToast('Add your Claude API key in Setup', 'error'); openSetup(); return; }
    if (!currentImageB64) { showToast('Please select an image first', 'error'); return; }

    document.getElementById('scanBtn').disabled = true;
    document.getElementById('loadingBar').classList.add('visible');
    document.getElementById('loadingMsg').classList.add('visible');
    document.getElementById('resultCard').classList.remove('visible');

    try {
      const response = await fetch('https://api.anthropic.com/v1/messages', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'x-api-key': config.claudeKey, 'anthropic-version': '2023-06-01', 'anthropic-dangerous-direct-browser-access': 'true' },
        body: JSON.stringify({
          model: 'claude-opus-4-5-20251101',
          max_tokens: 500,
          messages: [{
            role: 'user',
            content: [
              { type: 'image', source: { type: 'base64', media_type: 'image/jpeg', data: currentImageB64 } },
              { type: 'text', text: `Extract data from this receipt and return ONLY valid JSON (no markdown, no explanation):
{
  "date": "YYYY-MM-DD or best guess",
  "merchant": "store or restaurant name",
  "items": "comma-separated list of main items",
  "total": "final total amount as number only e.g. 24.99"
}
If you cannot read a field clearly, make your best guess. Always return valid JSON.` }
            ]
          }]
        })
      });

      const data = await response.json();
      if (!response.ok) throw new Error(data.error?.message || 'Claude API error');

      const raw = data.content[0].text.trim();
      let parsed;
      try {
        parsed = JSON.parse(raw);
      } catch {
        const match = raw.match(/\{[\s\S]*\}/);
        parsed = match ? JSON.parse(match[0]) : null;
      }
      if (!parsed) throw new Error('Could not parse receipt data');

      document.getElementById('resDate').value     = parsed.date     || '';
      document.getElementById('resMerchant').value = parsed.merchant || '';
      document.getElementById('resItems').value    = parsed.items    || '';
      document.getElementById('resTotal').value    = parsed.total    || '';

      document.getElementById('resultCard').classList.add('visible');
      showToast('âœ“ Receipt scanned!', 'success');

    } catch (err) {
      showToast('Error: ' + err.message, 'error');
    } finally {
      document.getElementById('scanBtn').disabled = false;
      document.getElementById('loadingBar').classList.remove('visible');
      document.getElementById('loadingMsg').classList.remove('visible');
    }
  }

  // â”€â”€ SYNC TO SHEETS â”€â”€
  async function syncToSheets() {
    if (!config.scriptUrl) { showToast('Add your Apps Script URL in Setup', 'error'); openSetup(); return; }

    const payload = {
      date:     document.getElementById('resDate').value,
      merchant: document.getElementById('resMerchant').value,
      items:    document.getElementById('resItems').value,
      total:    document.getElementById('resTotal').value,
    };

    document.getElementById('submitBtn').disabled = true;
    document.getElementById('submitBtn').textContent = 'â†— Syncingâ€¦';

    try {
      await fetch(config.scriptUrl, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });

      // Add to local history
      history.unshift({ ...payload, scannedAt: new Date().toLocaleString() });
      if (history.length > 50) history.pop();
      localStorage.setItem('rcp_history', JSON.stringify(history));
      renderHistory();

      showToast('âœ“ Added to Google Sheets!', 'success');
      clearImage();
      document.getElementById('resultCard').classList.remove('visible');

    } catch (err) {
      showToast('Sync error: ' + err.message, 'error');
    } finally {
      document.getElementById('submitBtn').disabled = false;
      document.getElementById('submitBtn').innerHTML = 'â†— Add to Google Sheets';
    }
  }

  // â”€â”€ HISTORY â”€â”€
  function renderHistory() {
    const el = document.getElementById('historyList');
    if (!history.length) {
      el.innerHTML = '<div class="history-empty">No receipts scanned yet.<br/>Your history will appear here.</div>';
      return;
    }
    el.innerHTML = history.slice(0, 10).map(r => `
      <div class="history-item">
        <div class="history-item-left">
          <div class="history-item-merchant">${r.merchant || 'Unknown merchant'}</div>
          <div class="history-item-meta">${r.date || 'â€”'} Â· ${r.scannedAt}</div>
        </div>
        <div class="history-item-price">$${parseFloat(r.total || 0).toFixed(2)}</div>
      </div>
    `).join('');
  }

  // â”€â”€ TOAST â”€â”€
  function showToast(msg, type = '') {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.className = 'toast ' + type;
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 3000);
  }
</script>
</body>
</html>
